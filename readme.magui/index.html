<!doctype html><html class=no-js lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><title>Magui - RISU</title><script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content><meta property="og:title" content="Magui"><meta property="og:description" content="Introduction Magui is a wrapper that calls functions from the Python library of Risu README.
Some problems are not detected only on one node, but are made by the aggregation of data across them, for example:
ntp sync galera replication status etc RHEL release differences Magui aims to use Risu for gathering the data and later, write plugins to analyze that information.
Highlights Reuse saved Risu.json to speed up analisys on several files, retrigger if inconsistencies"><meta property="og:type" content="article"><meta property="og:url" content="https://risuorg.github.io/readme.magui/"><meta property="article:section" content><meta property="article:published_time" content="2016-06-02T17:27:47+02:00"><meta property="article:modified_time" content="2016-06-02T17:27:47+02:00"><meta itemprop=name content="Magui"><meta itemprop=description content="Introduction Magui is a wrapper that calls functions from the Python library of Risu README.
Some problems are not detected only on one node, but are made by the aggregation of data across them, for example:
ntp sync galera replication status etc RHEL release differences Magui aims to use Risu for gathering the data and later, write plugins to analyze that information.
Highlights Reuse saved Risu.json to speed up analisys on several files, retrigger if inconsistencies"><meta itemprop=datePublished content="2016-06-02T17:27:47+02:00"><meta itemprop=dateModified content="2016-06-02T17:27:47+02:00"><meta itemprop=wordCount content="736"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="Magui"><meta name=twitter:description content="Introduction Magui is a wrapper that calls functions from the Python library of Risu README.
Some problems are not detected only on one node, but are made by the aggregation of data across them, for example:
ntp sync galera replication status etc RHEL release differences Magui aims to use Risu for gathering the data and later, write plugins to analyze that information.
Highlights Reuse saved Risu.json to speed up analisys on several files, retrigger if inconsistencies"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=dns-prefetch href=//fonts.googleapis.com><link rel=dns-prefetch href=//fonts.gstatic.com><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700"><link crossorigin=anonymous href=/assets/css/core.min.8ba71cf50a8381d9d94ef0bb5c7367004d6fe1de98371c5720571e9e48a03a3d.css integrity="sha256-i6cc9QqDgdnZTvC7XHNnAE1v4d6YNxxXIFcenkigOj0=" rel="preload stylesheet" as=style><link rel="shortcut icon" href=/favicon.ico><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-81705-14","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class="logo logo--mixed"><a class=logo__link href=/ title=RISU rel=home><div class="logo__item logo__imagebox"><img class=logo__img src=/images/risu.png></div><div class="logo__item logo__text"><div class=logo__title>RISU</div><div class=logo__tagline>Find and Report Issues</div></div></a></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>Menu</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=/about/><span class=menu__text>About</span></a></li><li class=menu__item><a class=menu__link href=/contributing/><span class=menu__text>Contributing</span></a></li><li class="menu__item menu__item--active"><a class=menu__link href=/readme.magui/><span class=menu__text>Magui</span></a></li><li class=menu__item><a class=menu__link href=/readme.risu/><span class=menu__text>Risu</span></a></li><li class=menu__item><a class=menu__link href=/changelog/><span class=menu__text>Timeline</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>Magui</h1><div class="post__meta meta"><div class="meta__item-author meta__item"><svg class="meta__icon icon icon-author" width="16" height="16" viewBox="0 0 12 16"><path d="M6 1c2.2.0 3.5 2 3.5 4.5C9.5 7 8.9 8.2 8 9c2.9.8 4 2.5 4 5v1H0v-1c0-2.5 1.1-4.2 4-5-.9-.8-1.5-2-1.5-3.5C2.5 3 3.8 1 6 1z"/></svg><span class=meta__text>RISU team</span></div><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2016-06-02T17:27:47+02:00>2016-06-02</time></div></div></header><div class="post__toc toc"><div class=toc__title>Page content</div><div class=toc__menu><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a></li><li><a href=#highlights>Highlights</a></li><li><a href=#installation>Installation</a></li><li><a href=#usage-help>Usage help</a><ul><li><a href=#running-a-check>Running a check</a></li></ul></li></ul></nav></div></div><div class="content post__content clearfix"><h2 id=introduction>Introduction</h2><p>Magui is a wrapper that calls functions from the Python library of Risu <a href=https://risuorg.github.io/readme.risu/>README</a>.</p><p>Some problems are not detected only on one node, but are made by the aggregation of data across them, for example:</p><ul><li>ntp sync</li><li>galera replication status</li><li>etc</li><li>RHEL release differences</li></ul><p>Magui aims to use Risu for gathering the data and later, write plugins to analyze that information.</p><h2 id=highlights>Highlights</h2><ul><li><p>Reuse saved Risu.json to speed up analisys on several files, retrigger if inconsistencies</p></li><li><p>Plugins use uuid to identify plugin properly and act on them.</p></li><li><p>Allows to get data from remote hosts with ansible-playbook</p></li><li><p>Autogrouping: based on metadata plugin, runs comparisons against sets of host roles, hostnames, etc for better spotting issues across systems.</p></li><li><p>Web interface using <code>risu.html?json=magui.json</code></p></li></ul><p>Check latest changes on &lt;Changelog.md></p><h2 id=installation>Installation</h2><ul><li>Just clone the git repository and execute it from there &lsquo;or&rsquo;</li><li>use &lsquo;pipsi&rsquo; or create a python virtual env to install package &lsquo;Risu&rsquo;<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#75715e># pipsi install Risu</span>
</span></span><span style=display:flex><span>Already using interpreter /usr/bin/python3
</span></span><span style=display:flex><span>Using base prefix <span style=color:#e6db74>&#39;/usr&#39;</span>
</span></span><span style=display:flex><span>New python executable in /home/iranzo/.local/venvs/Risu/bin/python3
</span></span><span style=display:flex><span>Also creating executable in /home/iranzo/.local/venvs/Risu/bin/python
</span></span><span style=display:flex><span>Installing setuptools, pip, wheel...done.
</span></span><span style=display:flex><span>Collecting Risu
</span></span><span style=display:flex><span>Installing collected packages: Risu
</span></span><span style=display:flex><span>Successfully installed Risu-0.1.0.dev1072
</span></span><span style=display:flex><span>  Linked script /home/iranzo/.local/bin/Risu.py
</span></span><span style=display:flex><span>  Linked script /home/iranzo/.local/bin/magui.py
</span></span><span style=display:flex><span>Done.
</span></span></code></pre></div><ul><li>Pipsi will take care of installing a virtual environment and link to binary folder so you can call Risu.py or magui.py directly</li><li>Remember that pypi package might not contain all the latests plugins features as the github repo one.</li></ul></li><li>Container:<ul><li>Use our automatically built container in docker hub:<ul><li><code>docker run --user=$(id -u) --rm -v $PATHTOSOSREPORT:/data:Z Risu/Risu:latest /data --entrypoint="magui.py"</code></li></ul></li><li>or build your own using the included <code>Dockerfile</code> in the git checkout.<ul><li><code>docker build . -f Dockerfile.centos7-atomic -t Risu:latest</code> # (from git checkout, then note image id)</li><li><code>docker run --user=$(id -u) --rm -v $PATHTOSOSREPORT:/data:Z Risu:latest /data --entrypoint="magui.py"</code></li></ul></li><li>Notes about using docker:<ul><li>Docker passes as volume the path specified under /data so we do use that parameter with Risu for running the tests.</li><li>The default user id within the container is 10001 and the commands or sosreport permissions doesn&rsquo;t allow that user to gather all the information, so the container is required to run as the current user.</li></ul></li></ul></li></ul><h2 id=usage-help>Usage help</h2><p>Plugins for Magui are to be written in Python, check next section for details.</p><pre tabindex=0><code>usage: magui.py [arguments] [-h] [-d {INFO,DEBUG,WARNING,ERROR,CRITICAL}]
                            [--list-plugins] [--description] [-m MPATH]
                            [--output FILENAME] [--run] [--hosts hosts] [-q]
                            [-i SUBSTRING] [-x SUBSTRING] [-p [0-1000]]
                            [-mf MFILTER] [--lang]
                            [sosreports [sosreports ...]]

Processes several generic archives/sosreports scripts in a uniform way, to
interpret status that depend on several systems data

positional arguments:
  sosreports

optional arguments:
  -h, --help            show this help message and exit
  -d {INFO,DEBUG,WARNING,ERROR,CRITICAL}, --loglevel {INFO,DEBUG,WARNING,ERROR,CRITICAL}
                        Set log level
  --list-plugins        Print a list of discovered Magui plugins and exit
  --description         With list-plugins, also outputs plugin description
  -m MPATH, --mpath MPATH
                        Set path for Magui plugin location if not default
  --output FILENAME, -o FILENAME
                        Write results to JSON file FILENAME
  --run, -r             Force run of Risu instead of reading existing
                        &#39;Risu.json&#39;
  --hosts hosts         Gather data via ansible from remote hosts to process.

Filtering options:
  -q, --quiet           Enable quiet mode
  -i SUBSTRING, --include SUBSTRING
                        Only include plugins that contain substring
  -x SUBSTRING, --exclude SUBSTRING
                        Exclude plugins that contain substring
  -p [0-1000], --prio [0-1000]
                        Only include plugins are equal or above specified prio
  -mf MFILTER, --mfilter MFILTER
                        Only include Magui plugins that contains in full path
                        that substring
  --lang                Define locale to use
</code></pre><p>Magui can be executed using the Risu docker image as well, by modifying
the entrypoint:</p><p>In a directory structure as:</p><pre tabindex=0><code>/path/to/my/sosreports/
├── sosreport-overcloud-controller-0
├── sosreport-overcloud-controller-1
└── sosreport-overcloud-controller-2
</code></pre><p><code>docker run --user=$(id -u) --rm --entrypoint="magui.py" -v /path/to/my/sosreports/:/data:Z Risu:latest -q /data/sosreport-overcloud-controller-0/ /data/sosreport-overcloud-controller-1/ /data/sosreport-overcloud-controller-2/</code></p><h3 id=running-a-check>Running a check</h3><p>This is an example of execution of Magui against a set of sosreports with <code>seqno</code> plugin of Risu enabled.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#75715e>#magui.py * -i seqno # (filtering for ‘seqno’ plugins.</span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span><span style=color:#e6db74>&#39;/home/remote/piranzo/Risu/Risu/plugins/openstack/mysql/seqno.sh&#39;</span>: <span style=color:#f92672>{</span><span style=color:#e6db74>&#39;ctrl0.localdomain&#39;</span>: <span style=color:#f92672>{</span><span style=color:#e6db74>&#39;err&#39;</span>: <span style=color:#e6db74>&#39;08a94e67-bae0-11e6-8239-9a6188749d23:36117633\n&#39;</span>,
</span></span><span style=display:flex><span>                                                                                                   <span style=color:#e6db74>&#39;out&#39;</span>: <span style=color:#e6db74>&#39;&#39;</span>,
</span></span><span style=display:flex><span>                                                                                                   <span style=color:#e6db74>&#39;rc&#39;</span>: 0<span style=color:#f92672>}</span>,
</span></span><span style=display:flex><span>                                                                             <span style=color:#e6db74>&#39;ctrl1.localdomain&#39;</span>: <span style=color:#f92672>{</span><span style=color:#e6db74>&#39;err&#39;</span>: <span style=color:#e6db74>&#39;08a94e67-bae0-11e6-8239-9a6188749d23:36117633\n&#39;</span>,
</span></span><span style=display:flex><span>                                                                                                   <span style=color:#e6db74>&#39;out&#39;</span>: <span style=color:#e6db74>&#39;&#39;</span>,
</span></span><span style=display:flex><span>                                                                                                   <span style=color:#e6db74>&#39;rc&#39;</span>: 0<span style=color:#f92672>}</span>,
</span></span><span style=display:flex><span>                                                                             <span style=color:#e6db74>&#39;ctrl2.localdomain&#39;</span>: <span style=color:#f92672>{</span><span style=color:#e6db74>&#39;err&#39;</span>: <span style=color:#e6db74>&#39;08a94e67-bae0-11e6-8239-9a6188749d23:36117633\n&#39;</span>,
</span></span><span style=display:flex><span>                                                                                                   <span style=color:#e6db74>&#39;out&#39;</span>: <span style=color:#e6db74>&#39;&#39;</span>,
</span></span><span style=display:flex><span>                                                                                                   <span style=color:#e6db74>&#39;rc&#39;</span>: 0<span style=color:#f92672>}}}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>On this example, UUID and SEQNO is shown <span style=color:#66d9ef>for</span> each controller.
</span></span></code></pre></div><h4 id=running-a-check-against-remote-hosts>Running a check against remote hosts</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#75715e># Prepare host list in ansible-style</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;host1&#34;</span> &gt; hosts
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;host2&#34;</span> &gt;&gt; hostsfile
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Run magui against them</span>
</span></span><span style=display:flex><span>./magui.py --hosts hostsfile
</span></span></code></pre></div><h4 id=autogrouping>Autogrouping</h4><p></p><p>Magui does check <code>metadata</code> for finding host roles or hostnames that should be checked together and generates additional json files for them.</p><h1 id=plugin-development-for-magui>Plugin development for Magui</h1><p>Please do check &lt;doc/magui-plugin-development.md> for more details.</p><p>Please if you have any idea on any improvements please do not hesitate to open an issue or submit your contributions.</p></div></article></main><div class="authorbox clearfix"><figure class=authorbox__avatar><img alt="RISU team avatar" src=/images/risu.png class=avatar height=90 width=90></figure><div class=authorbox__header><span class=authorbox__name>About RISU team</span></div><div class=authorbox__description>Risu team works on getting an easy to extend framework for reporting issues at your systems</div></div><nav class="pager flex"><div class="pager__item pager__item--prev"><a class=pager__link href=/readme.risu/ rel=prev><span class=pager__subtitle>«&#8201;Previous</span><p class=pager__title>Risu</p></a></div><div class="pager__item pager__item--next"><a class=pager__link href=/contributing/ rel=next><span class=pager__subtitle>Next&#8201;»</span><p class=pager__title>Contributing</p></a></div></nav></div></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2023 RISUorg team.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div><script async defer src=/js/menu.js></script>
<script src=/js/custom.js></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async></script></body></html>